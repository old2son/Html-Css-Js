<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/302292 (zh-CN); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="2985"/>

<div>
<span style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
	<div>
		<p dir="ltr" style="margin-right: 0px;">在Jquery中，$是JQuery的别名，所有使用$的地方也都可以使用JQuery来替换，如$('#msg')等同于JQuery('#msg')的写法。然而，当我们引入多个js库后，在另外一个js库中也定义了$符号的话，那么我们在使用$符号时就发生了冲突。下面以引入两个库文件jquery.js和prototype.js为例来进行说明。<br/><strong>第一种情况：jquery.js在prototype.js之后进行引入,如：</strong></p>
		<div>&lt;script src=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">prototype.js</span><span style="color: rgb(128, 0, 0);">&quot;</span> type=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">text/javascript</span><span style="color: rgb(128, 0, 0);">&quot;</span>/&gt;<br/>
&lt;script src=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">jquery.js</span><span style="color: rgb(128, 0, 0);">&quot;</span> type=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">text/javascript</span><span style="color: rgb(128, 0, 0);">&quot;</span>/&gt;</div>
		<p dir="ltr" style="margin-right: 0px;"><br/>
在这种情况下,我们在自己的js代码中如下写的话：</p>
		<div>$(<span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">#msg</span><span style="color: rgb(128, 0, 0);">'</span>).hide();</div>
		<p dir="ltr" style="margin-right: 0px;"><br/>
$永远代表的是jquery中定义的$符号，也可以写成JQuery('#msg').hide();如果想要使用prototype.js中定义的$,我们在后面再介绍。</p>
		<p dir="ltr" style="margin-right: 0px;"><br/><strong>第二种情况：jquery.js在prototype.js之前进行引入,如：<br/></strong></p>
		<div>&lt;script src=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">jquery.js</span><span style="color: rgb(128, 0, 0);">&quot;</span> type=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">text/javascript</span><span style="color: rgb(128, 0, 0);">&quot;</span>/&gt;<br/>
&lt;script src=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">prototype.js</span><span style="color: rgb(128, 0, 0);">&quot;</span> type=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">text/javascript</span><span style="color: rgb(128, 0, 0);">&quot;</span>/&gt;</div>
		<p dir="ltr" style="margin-right: 0px;"><br/>
在这种情况下,我们在自己的js代码中如下写的话：</p>
		<div>$(<span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">#msg</span><span style="color: rgb(128, 0, 0);">'</span>).hide();</div>
		<p dir="ltr" style="margin-right: 0px;"><br/>
$此时代表的prototype.js中定义的$符号，如果我们想要调用jquery.js中的工厂选择函数功能的话，只能用全称写法JQuery('#msg').hide().</p>
		<p>下面先介绍在第一种引入js库文件顺序的情况下，如何正确的使用不同的js库中定义的$符号。</p>
		<p><strong>一.使用JQuery.noConflict()</strong><br/>
该方法的作用就是让Jquery放弃对$的所有权，将$的控制权交还给prototype.js,因为jquery.js是后引入的，所以最后拥有$控制权的是jquery。它的返回值是JQuery。当在代码中调用了该方法以后，我们就不可以使用$来调用jquery的方法了，此时$就代表在prototype.js库中定义的$了。如下：</p>
		<div>JQuery.noConflict();<br/><br/><span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">此处不可以再写成$('#msg').hide(),此时的$代表prototype.js中定义的$符号。</span> <span style="color: rgb(0, 128, 0);"><br/></span>JQuey(<span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">#msg</span><span style="color: rgb(128, 0, 0);">'</span>).hide();<br/></div>
		<p><br/>
自此以后$就代表prototype.js中定义的$,jquery.js中的$无法再使用,只能使用jquery.js中$的全称JQuery了。</p>
		<p><br/><strong>二.自定义JQuery的别名<br/></strong> 如果觉得第一种方法中使用了JQuery.noConflict()方法以后,只能使用JQuery全称比较麻烦的话，我们还可以为JQuery重定义别名。如下：</p>
		<div>var $j=JQuery.noConflict();<br/>
$j(<span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">#msg</span><span style="color: rgb(128, 0, 0);">'</span>).hide();<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">此处$j就代表JQuery</span></div>
		<p><br/>
自此以后$就代表prototype.js中定义的$,jquey.js中的$无法再使用,只能使用$j来作为jquey.js中JQuery的别名了。</p>
		<p><br/><strong>三.使用语句块，在语句块中仍然使用jquery.js中定义的$，如下：</strong></p>
		<div>JQuery.noConflict();<br/>
JQuery(document).ready(function($){<br/>
$(<span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">#msg</span><span style="color: rgb(128, 0, 0);">'</span>).hide();<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">此时在整个ready事件的方法中使用的$都是jquery.js中定义的$.</span> <span style="color: rgb(0, 128, 0);"><br/></span>});</div>
		<p>或者使用如下语句块：</p>
		<div>(function($){<br/>
.....<br/>
$(<span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">#msg</span><span style="color: rgb(128, 0, 0);">'</span>).hide();<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">此时在这个语句块中使用的都是jquery.js中定义的$.</span> <span style="color: rgb(0, 128, 0);"><br/></span>})(JQuery)</div>
		<p><br/>
如果在第二种引入js库文件顺序的情况下,如何使用jquery.js中的$,我们还是可以使用上面介绍的语句块的方法，如：</p>
		<div>&lt;script src=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">jquery.js</span><span style="color: rgb(128, 0, 0);">&quot;</span> type=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">text/javascript</span><span style="color: rgb(128, 0, 0);">&quot;</span>/&gt;<br/>
&lt;script src=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">prototype.js</span><span style="color: rgb(128, 0, 0);">&quot;</span> type=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">text/javascript</span><span style="color: rgb(128, 0, 0);">&quot;</span>/&gt;<br/>
&lt;script type=<span style="color: rgb(128, 0, 0);">&quot;</span><span style="color: rgb(128, 0, 0);">text/javascript</span><span style="color: rgb(128, 0, 0);">&quot;</span>&gt;<br/><br/>
(function($){<br/>
.....<br/>
$(<span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">#msg</span><span style="color: rgb(128, 0, 0);">'</span>).hide();<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">此时在这个语句块中使用的都是jquery.js中定义的$.</span> <span style="color: rgb(0, 128, 0);"><br/></span>})(JQuery)<br/>
&lt;/script&gt;</div>
		<div><br/></div>
		<div>这种使用语句块的方法非常有用，在我们自己写jquery插件时,应该都使用这种写法，因为我们不知道具体工作过程中是如何顺序引入各种js库的,而这种语句块的写法却能屏蔽冲突。</div>
	</div>
	<div><br/></div>
	<div>
		<table border="1" cellpadding="2" cellspacing="0" width="100%">
			<tbody>
				<tr>
					<td valign="top">
						<p>jquery提供了一个noConfilict的API来解决冲突。</p>
						<p>使用方法：</p>
						<p>jQuery.noConflict()：运行这个函数将变量$的控制权让渡给第一个实现它的那个库。</p>
						<p>jQuery.noConflict(true)：将$和jQuery的控制权都交还给原来的库。</p>
						<p>第一种：</p>
						<div>
							<pre>jQuery.noConflict();
<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);"> Do something with jQuery</span>
jQuery(&quot;div p&quot;).hide();
<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);"> Do something with another library's $()</span>
$(&quot;content&quot;).style.display = 'none';
</pre>
						</div>
						<p>第二种：</p>
						<div>
							<pre>jQuery.noConflict();
(<span style="color: rgb(0, 0, 255);">function</span>($) { 
  $(<span style="color: rgb(0, 0, 255);">function</span>() {
    <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);"> more code using $ as alias to jQuery</span>  });
})(jQuery);
<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);"> other code using $ as an alias to the other library</span></pre>
						</div>
						<p>第三种：</p>
						<div>
							<pre>jQuery.noConflict()(<span style="color: rgb(0, 0, 255);">function</span>(){
    <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);"> code using jQuery</span>}); 
<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);"> other code using $ as an alias to the other library</span></pre>
						</div>
						<p>第四种：</p>
						<div>
							<pre><span style="color: rgb(0, 0, 255);">var</span> j = jQuery.noConflict();
<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);"> Do something with jQuery</span>
j(&quot;div p&quot;).hide();
<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);"> Do something with another library's $()</span>
$(&quot;content&quot;).style.display = 'none';
</pre>
						</div>
						<p>第五种：</p>
						<div>
							<div><a title="复制代码"><img src="Jquery的$命名冲突_files/Image.gif" type="image/gif" alt="复制代码" height="20" style="cursor: default;cursor: default;cursor: default;" width="20"/></a></div>
							<pre><span style="color: rgb(0, 0, 255);">var</span> dom = {};
dom.query = jQuery.noConflict(<span style="color: rgb(0, 0, 255);">true</span>);
<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);"> Do something with the new jQuery</span>
dom.query(&quot;div p&quot;).hide();
<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);"> Do something with another library's $()</span>
$(&quot;content&quot;).style.display = 'none';
<span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);"> Do something with another version of jQuery</span>
jQuery(&quot;div &gt; p&quot;).hide();
</pre>
						</div>
						<p>noConfilict的源码：</p>
						<div>
							<pre>noConflict: <span style="color: rgb(0, 0, 255);">function</span>( deep ) {
    <span style="color: rgb(0, 0, 255);">if</span> ( window.$ === jQuery ) {
        window.$ = _$;
    }

    <span style="color: rgb(0, 0, 255);">if</span> ( deep &amp;&amp; window.jQuery === jQuery ) {
        window.jQuery = _jQuery;
    }

    <span style="color: rgb(0, 0, 255);">return</span> jQuery;
},
</pre>
						</div>
						<p>在jquery源码的最开头定义了：</p>
						<div>
							<pre>(<span style="color: rgb(0, 0, 255);">function</span>(){ 
　　<span style="color: rgb(0, 0, 255);">var</span> 
       <span style="color: rgb(0, 128, 0);">//</span> 
    _jQuery = window.jQuery,
    _$ = window.$,
       <span style="color: rgb(0, 128, 0);">//</span> 
})();<br/>为了防止$和就jQuery被覆盖而进行保存。
</pre>
						</div>
						<p>当deep为空的时候，“_$”覆盖“window.$”，“$”的常规功能失效，但jQuery还可以继续使用。当有新的库中重新定义“$”的时候，“jQuery”继续为jQquery的常规功能，而“$”就不是jQuery中的了，它是属于新的库的常规功能；</p>
						<p>当deep不为空的时候，它将“_jQuery”覆盖“window.jQuery”，这样导致可能jQuery插件失效；另外方法返回的jQuery，实际上没有被覆盖。通过它完全可以移到新的一个命名空间，如<span style="text-decoration: underline;">dom.query = jQuery.noConflict(true); dom.query(&quot;div p&quot;).hide();</span></p>
					</td>
				</tr>
			</tbody>
		</table>
		<div><br/></div>
	</div>
	<div><br/></div>
	<div><br/></div>
	<div><br/></div>
	<div><br/></div>


</span>
</div></body></html> 