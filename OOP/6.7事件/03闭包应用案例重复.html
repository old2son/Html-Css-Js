<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>闭包应用案例</title>
    <style type="text/css">
    #bookList{
        background: lightBlue;
        position: absolute;
        top: 130px;
        left: 50%;
        margin-left:-450px;
        width:900px;
    }
    #bookList table{
        border-right:1px solid red;
        border-bottom: 1px solid red;
    }
    #bookList table tbody tr th,td{
        border-top: solid 1px red;
        border-left: solid 1px red;
        width: 160px;
        text-align: center;
    }
    </style>
    <script type="text/javascript">
    var data = [{
            name:'红楼梦',
            author:'曹雪芹',
            category:'文学',
            isOk:'推荐',
            desc:'封建社会的缩影',
            operation:'删除'
        },{
            name:'三国演义',
            author:'罗贯中',
            category:'文学',
            isOk:'推荐',
            desc:'你死我活的杀伐纷争',
            operation:'删除'
        },{
            name:'西游记',
            author:'吴承恩',
            category:'文学',
            isOk:'推荐',
            desc:'师徒四人历险记',
            operation:'删除'
        },{
            name:'水浒传',
            author:'施耐庵',
            category:'文学',
            isOk:'推荐',
            desc:'草寇投降记',
            operation:'删除'
        }
    ];
    function Mylist(data){
        this.data = data;
        this.target = document.getElementsByTagName('tbody')[0];
    }
    Mylist.prototype.init = function(){
        if(!this.data){
            return;
        }
        for(var i=0;i<this.data.length;i++){
            var item = this.data[i];
            var tag = '<td>'+item.name+'</td><td>'+item.author+'</td><td>'+item.category+'</td><td>'+item.isOk+'</td><td>'+item.desc+'</td><td>'+item.operation+'</td>';
            var tr = document.createElement('tr');
            tr.id = 'myItem'+i;
            tr.innerHTML = tag;
            this.target.appendChild(tr);
            var btn = tr.getElementsByTagName('td')[5];
            //闭包可以缓存中间的状态值
            // btn.onclick = (function(j){
            //     return function(){
            //         var tr = document.getElementById('myItem'+j);
            //         tr.parentNode.removeChild(tr);        
            //     }
            // })(i);

            btn.onclick = function(){
                var tr = this.parentNode; 
                tr.parentNode.removeChild(tr);         
            }
            //------------------------------------------------------
            btn.onmouseover = function(){
                this.style.color = 'blue';
                this.style.cursor = 'pointer';
            }
            btn.onmouseout = function(){
                this.style.color = 'black';
            }
        }
    }
    window.onload = function(){
        var list = new Mylist(data);
        list.init();
    }
    </script>
</head>
<body>
<div id="bookList">
    <table cellspacing="0" cellpadding="0">
        <tbody>
            <tr>
                <th>图书名称</th>
                <th>图书作者</th>
                <th>图书分类</th>
                <th>是否推荐</th>
                <th>图书描述</th>
                <th>操作</th>
            </tr>

        </tbody>
    </table>
</div>
</body>
</html>