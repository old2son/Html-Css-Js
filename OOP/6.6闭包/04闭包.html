<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>闭包</title>
</head>
<body>
	<script>
		/*		
			从函数外部访问函数内部的变量

		*/

		/*-------普通函数---------*/ 
		// var flag = 0;
		// function foo(){
		// 	var abc = 123;
		// 	flag = abc;
		// }
		// foo();
		// console.log(flag);

		// function foo(){
		// 	var a = 1;
		// 	return a;
		// }
		// var ret = foo();
		// console.log(ret);

		// var fn = function(data){
		// 	console.log(data);
		// }
		// function foo(fn){
		// 	var b = 2;
		// 	fn(b);
		// }
		// foo(fn);

		/*	
			闭包

		*/
		/*------------闭包---------------*/
		// function foo(){
		// 	var num = Math.random();
		// 	return num;
		// }
		// var ret1 = foo();
		// var ret2 = foo();
		// console.log(ret1);
		// console.log(ret2);
		// 让上面两个值相同，用闭包试试 

		// function foo() {
		// 	var num = Math.random();
		// 	return function(){
		// 		return num++;
		// 	};
		// }
		// var fn = foo();
		// var ret1 = fn();
		// var ret2 = fn();
		// var ret3 = fn();
		// console.log(ret1);
		// console.log(ret2);
		// console.log(ret3);

		function foo(){
			var num = 0;
			return function(){
				num++;
				return num;
			}
		}
		var fn = foo();
		var ret1 = fn();
		var ret2 = fn();
		var ret3 = fn();
		console.log(ret1);
		console.log(ret2);
		console.log(ret3);
		// for(var i=0;i<3;i++){
		// 	arr[i] = function(){
		// 		console.log(i);
		// 	}
		// }
		// arr[0]();
		// arr[1]();
		// arr[2]();
		// 要上面输出 0、1、2

		// ()() 自执行函数,类似function abc()前一个为函数名，后一个为执行函数的括号
		var arr = [];
		for(var i=0;i<3;i++){
			arr[i] = (function(n){
				// 这块区域是闭包
				var k = n;
				// 这里形成一个封闭的环境，独立的局部作用域，这样的作用域有3份，arr[0]-arr[2];
				return function(){
					console.log(k);
				}
			})(i);
		}
		arr[0]();
		arr[1]();
		arr[2]();
	</script>
</body>
</html>